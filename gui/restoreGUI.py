import customtkinter as ct
import sys
import os
if __name__ == "__main__":
    sys.path.insert(1, '../quarantine')
from quarantine import loadRecord, restore

def restoreGUI(recordPath="../quarantine/quarantined.json"):
    def buttonRestore():
        dest = os.path.normpath(selection.get())
        path = ""
        for key, val in record.items():
            if val == dest:
                path = key
                break
        print("Restoring " + path)
        print(restore(path, recordPath))
    
    ct.set_appearance_mode("dark")
    ct.set_default_color_theme("dark-blue")
    root = ct.CTk()
    root.geometry("300x300")
    root.title("Restore Files")
    #frame = ct.CTkFrame(master=root)
    #frame.pack(pady=20, padx=60, fill="both", expand=True)
    
    record = loadRecord(recordPath)
    fileOptions = list(record.values())
    selection = ct.StringVar(value="Select File to Restore")
    optionmenu = ct.CTkOptionMenu(master=root, values=fileOptions, variable=selection)
    optionmenu.pack(pady=12, padx=10)
    
    restoreButton = ct.CTkButton(master=root, text="Restore File", command=buttonRestore)
    restoreButton.pack(pady=12, padx=10)
    
    root.mainloop()
    
def testPrint(path):
    print(path)
    
if __name__ == "__main__":
    restoreGUI()