import sys
sys.path.insert(1, '../')
from ADD_SYS_PATHS import addSysPaths
addSysPaths()
from datetime import *
import os

path = os.getcwd()
os.makedirs(path + "\..\__logs", exist_ok=True)

#Logs a scanned file for a given timestamp and filepath
def scanLog(timestamp, filepath):
    entry = f"SCANNED FILE: {filepath}\n"
    if not os.path.exists(f"__logs\{timestamp}"):
        os.makedirs(path + f"\..\__logs\{timestamp}", exist_ok=True)
    
    with open(path + f"\..\__logs\{timestamp}\ScanLogs.txt","a") as logFile:
        logFile.write(entry)

#Logs a found infection, filepath, and action taken for a given timestamp
def infectionLog(timestamp,filepath,infection_name,action):
    entry = f"INFECTION FOUND IN FILE:{filepath} - {infection_name} ACTION:{action}\n"
    if not os.path.exists(f"__logs\{timestamp}"):
        os.makedirs(path + f"\..\__logs\{timestamp}")
    
    with open(path + f"\..\__logs\{timestamp}\InfectionLogs.txt","a") as logFile:
        logFile.write(entry)
    
#Logs an error for a given timestamp
def errorLog(timestamp,filepath,error):
    entry = f"ERROR:{filepath} - {error}\n"
    if not os.path.exists(f"__logs\{timestamp}"):
        os.makedirs(path + f"\..\__logs\{timestamp}")
    
    with open(path + f"\..\__logs\{timestamp}\ErrorLogs.txt","a") as logFile:
        logFile.write(entry)
