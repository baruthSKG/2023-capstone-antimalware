#include <iostream>
#include "sqlite3.h"
using std::string;
using std::cout;
using std::endl;

string compareHashDB(string file_hash) {
	sqlite3* db;
	sqlite3_stmt* stmt;
	sqlite3_open("HashDB.db", &db);
	sqlite3* databases[] = { db };
	int rc;

	for (sqlite3* db : databases) {
	        string sql_statement = "SELECT name FROM HashDB WHERE hash=\'" + file_hash + "\'";
                rc = sqlite3_prepare_v2(db, sql_statement.c_str(), -1, &stmt, 0);
		sqlite3_step(stmt);
		if (rc == SQLITE_OK) {
		    char* result = (char *)sqlite3_column_text(stmt, NULL);
            	    return result;
		}
		else {
            		return "No infections found!";
		}
	}
 }

int main() {
	cout << compareHashDB("38c07fde8a4d0c51ed48a80ee0931b62") << "\n";
}
